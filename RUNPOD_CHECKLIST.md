# RunPod Quick Reference - Never Forget Again!

## ðŸ†• First Time Setup (New Pod)

### Step 1: Upload Essential Files (~5 min)
```bash
# === ON YOUR MAC ===
export RUNPOD_PORT=12345  # Your port
export RUNPOD_HOST=123.45.67.89  # Your IP

cd /Users/kulsoom/workspace/learning/SurgViVQA-Audio

# Upload code and scripts
scp -P $RUNPOD_PORT -r \
    baselines test_set \
    verify_setup.py generate_audio_subset.py \
    setup_runpod_venv.sh activate_venv.sh \
    download_frames_figshare.sh run_all_baselines.sh \
    root@$RUNPOD_HOST:/workspace/SurgViVQA-Audio/
```

### Step 2: Download Frames on RunPod (~5-10 min)
```bash
# === ON RUNPOD ===
ssh root@$RUNPOD_HOST -p $RUNPOD_PORT

cd /workspace/SurgViVQA-Audio
bash download_frames_figshare.sh
# Downloads 7.6GB from Figshare, extracts frames
```

### Step 3: Setup Environment (~5 min - ONE TIME ONLY!)
```bash
# Still on RunPod
bash setup_runpod_venv.sh
# Creates venv at /workspace/venvs/surg-audio
# Installs PyTorch, transformers, librosa, whisper, etc.
```

### Step 4: Generate Audio (~1 min)
```bash
# Activate venv first!
source /workspace/venvs/surg-audio/bin/activate

# Generate audio for both test sets
python generate_audio_subset.py --input test_set/in_002-001.jsonl --output audio/in_002-001
python generate_audio_subset.py --input test_set/out_002-001.jsonl --output audio/out_002-001
```

### Step 5: Verify Setup
```bash
python verify_setup.py \
    --test_file test_set/in_002-001.jsonl \
    --frames_dir dataset/frames \
    --audio_dir audio/in_002-001
# Should show: âœ“ SETUP VERIFIED
```

### Step 6: Run Experiments ðŸš€
```bash
bash run_all_baselines.sh
# Takes ~1-2 hours
```

---

## ðŸ”„ Pod Restart (After Stopping Pod)

Everything in `/workspace` persists! Just need to reactivate.

### Quick Start (2 seconds)
```bash
# SSH in
ssh root@HOST -p PORT

# Navigate
cd /workspace/SurgViVQA-Audio

# Activate venv (ONLY STEP NEEDED!)
source /workspace/venvs/surg-audio/bin/activate

# Run experiments
bash run_all_baselines.sh
```

**That's it!** No reinstalling, no re-downloading.

---

## ðŸ“¥ Download Results

```bash
# === ON YOUR MAC ===
# After experiments finish
scp -P PORT -r root@HOST:/workspace/SurgViVQA-Audio/results/ ./results/

# Check what you got
ls -lh results/
```

---

## ðŸ†˜ Common Issues

### "ModuleNotFoundError: No module named 'edge_tts'"
**Fix**: You forgot to activate the venv!
```bash
source /workspace/venvs/surg-audio/bin/activate
```

### "Audio directory doesn't exist"
**Fix**: Generate audio first
```bash
python generate_audio_subset.py --input test_set/in_002-001.jsonl --output audio/in_002-001
```

### "Frame not found"
**Fix**: Re-run frame download
```bash
bash download_frames_figshare.sh
```

### Out of Memory (OOM)
**Fix**: Use smaller Whisper model in `run_all_baselines.sh`
```bash
# Edit line 32:
WHISPER_MODEL="base"  # Instead of "medium"
```

---

## ðŸ’° Cost Tracking

**RTX A6000 @ $0.79/hour**

| Action | Time | Cost |
|--------|------|------|
| First-time setup | ~20 min | $0.26 |
| Run all baselines | ~2 hours | $1.58 |
| **Total first run** | ~2.5 hours | **$1.84** |
| | | |
| **Restart + run** | ~2 hours | **$1.58** |

**Stop pod immediately after downloading results!**

---

## ðŸ“‹ File Checklist (What's on RunPod)

### Essential (Must Upload)
```
/workspace/SurgViVQA-Audio/
â”œâ”€â”€ baselines/
â”‚   â”œâ”€â”€ baseline1_text_image.py
â”‚   â”œâ”€â”€ baseline2_audio_image.py
â”‚   â”œâ”€â”€ baseline3_asr_pipeline.py
â”‚   â””â”€â”€ utils.py
â”œâ”€â”€ test_set/
â”‚   â”œâ”€â”€ in_002-001.jsonl
â”‚   â””â”€â”€ out_002-001.jsonl
â”œâ”€â”€ verify_setup.py
â”œâ”€â”€ generate_audio_subset.py
â”œâ”€â”€ setup_runpod_venv.sh
â”œâ”€â”€ activate_venv.sh
â”œâ”€â”€ download_frames_figshare.sh
â””â”€â”€ run_all_baselines.sh
```

### Generated on RunPod (Don't Upload)
```
/workspace/
â”œâ”€â”€ venvs/surg-audio/           # Created by setup script
â”œâ”€â”€ SurgViVQA-Audio/
â”‚   â”œâ”€â”€ dataset/frames/002-001/ # Downloaded from Figshare
â”‚   â”œâ”€â”€ audio/                  # Generated by generate_audio_subset.py
â”‚   â””â”€â”€ results/                # Created by baselines
```

---

## ðŸŽ¯ One-Command Checklist

### New Pod
```bash
# Upload, download, setup, generate, verify, run
bash download_frames_figshare.sh && \
bash setup_runpod_venv.sh && \
source /workspace/venvs/surg-audio/bin/activate && \
python generate_audio_subset.py --input test_set/in_002-001.jsonl --output audio/in_002-001 && \
python generate_audio_subset.py --input test_set/out_002-001.jsonl --output audio/out_002-001 && \
bash run_all_baselines.sh
```

### Restart Pod
```bash
# Just activate and run
cd /workspace/SurgViVQA-Audio && \
source /workspace/venvs/surg-audio/bin/activate && \
bash run_all_baselines.sh
```

---

## ðŸ§¹ Maintenance

### Check Storage Usage
```bash
du -sh /workspace/*
# venvs: ~2GB
# SurgViVQA-Audio: ~12GB (8GB frames + 2GB models + 2GB other)
# Total: ~15GB / 60GB volume
```

### Clean Up After Experiments
```bash
# Delete old results (optional)
rm -rf results/

# Keep everything else (venv, frames, audio persist)
```

---

## ðŸ’¡ Pro Tips

1. **Always activate venv first** - Put this in your muscle memory
2. **Stop pod immediately after downloading results** - Don't waste money
3. **Frames persist** - Never need to re-download (7.6GB)
4. **Venv persists** - Never need to reinstall packages
5. **Audio regenerates in 1 min** - OK to delete to save space

---

## ðŸ“ž Help Commands

```bash
# Check if venv exists
ls -la /workspace/venvs/surg-audio

# Check what Python you're using
which python

# Check if packages installed
pip list | grep transformers

# Check GPU
nvidia-smi

# Check frames
ls dataset/frames/002-001/ | wc -l  # Should be 25998

# Check audio
ls audio/in_002-001/ | wc -l  # Should be 50
```
